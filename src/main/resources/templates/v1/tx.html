<!-- src/main/resources/templates/tx.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/><title>Transactions</title>
    <style>
    body{font-family:system-ui,Segoe UI,Roboto,sans-serif;margin:24px;}
    .bar{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
    table{border-collapse:collapse;width:100%}
    th,td{border-bottom:1px solid #eee;padding:.5rem .75rem;text-align:left}
    th{background:#fafafa;position:sticky;top:0}
    .right{text-align:right}
  </style>
</head>
<body>
<h1>Transactions</h1>

<form class="bar" method="get" action="/tx">
    <label>Asset</label><input name="asset" th:value="${asset}" placeholder="e.g. BTC"/>
    <label>Exchange</label><input name="exchange" th:value="${exchange}" placeholder="binance/kraken"/>
    <label>Account</label><input name="account" th:value="${account}"/>
    <button type="submit">Apply</button>
    <a th:href="@{/tx}">Clear</a>
    <a th:href="@{'/reconcile'(account=${account})}">Reconcile</a>
</form>

<table>
    <thead>
    <tr>
        <th>Date</th><th>Exchange</th><th>Account</th><th>Asset</th><th>Type</th>
        <th class="right">Qty</th><th class="right">Price</th><th class="right">Fee</th><th>Fee Asset</th>
        <th>Ext ID</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="t : ${rows}">
        <td th:text="${#temporals.format(t.ts,'yyyy-MM-dd HH:mm')}"></td>
        <td th:text="${t.exchange}"></td>
        <td th:text="${t.accountRef}"></td>
        <td th:text="${t.asset}"></td>
        <td th:text="${t.type}"></td>
        <td class="right" th:text="${#numbers.formatDecimal(t.qty,1,8)}"></td>
        <td class="right" th:text="${t.price == null ? '-' : #numbers.formatDecimal(t.price,1,8)}"></td>
        <td class="right" th:text="${t.fee == null ? '-' : #numbers.formatDecimal(t.fee,1,8)}"></td>
        <td th:text="${t.feeAsset == null ? '-' : t.feeAsset}"></td>
        <td th:text="${t.externalId}"></td>
    </tr>
    <tr th:if="${#lists.isEmpty(rows)}"><td colspan="10">No transactions.</td></tr>
    </tbody>
</table>
</body>
</html>
